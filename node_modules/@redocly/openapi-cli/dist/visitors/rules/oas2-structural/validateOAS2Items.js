"use strict";

var _utils = require("../../../utils");

class ValidateOAS2Items {
  static get rule() {
    return 'oas2-schema/items';
  }

  get validators() {
    return {
      type(node, ctx) {
        if (node && !node.type) {
          return ctx.createError(ctx.messageHelpers.missingRequiredField('type'), 'key');
        }

        if (node && node.type && typeof node.type !== 'string') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('string'), 'value');
        return null;
      },

      format(node, ctx) {
        if (node && node.format && typeof node.format !== 'string') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('string'), 'value');
        return null;
      },

      items(node, ctx) {
        if (node && node.type === 'array' && !node.items) {
          return ctx.createError(ctx.messageHelpers.missingRequiredField('items'), 'key');
        }

        return null;
      },

      collectionFormat(node, ctx) {
        if (node && node.collectionFormat && typeof node.collectionFormat !== 'string') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('string'), 'value');

        if (node.collectionFormat && !['csv', 'ssv', 'tsv', 'pipes', 'multi'].includes(node.collectionFormat)) {
          const possibleAlternate = (0, _utils.getClosestString)(node.type, ['csv', 'ssv', 'tsv', 'pipes', 'multi']);
          return ctx.createError('The value of "collectionFormat" field can be one of following only: "csv", "ssv", "tsv", "pipes", "multi".', 'value', {
            possibleAlternate
          });
        }

        return null;
      },

      pattern(node, ctx) {
        if (node && node.pattern && typeof node.pattern !== 'string') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('string'), 'value');
        return null;
      },

      maximum(node, ctx) {
        if (node && node.maximum && typeof node.maximum !== 'number') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('number'), 'value');
        return null;
      },

      minimum(node, ctx) {
        if (node && node.minimum && typeof node.minimum !== 'number') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('number'), 'value');
        return null;
      },

      maxLength(node, ctx) {
        if (node && node.maxLength && typeof node.maxLength !== 'number') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('number'), 'value');
        return null;
      },

      minLength(node, ctx) {
        if (node && node.minLength && typeof node.minLength !== 'number') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('number'), 'value');
        return null;
      },

      maxItems(node, ctx) {
        if (node && node.maxItems && typeof node.maxItems !== 'number') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('number'), 'value');
        return null;
      },

      minItems(node, ctx) {
        if (node && node.minItems && typeof node.minItems !== 'number') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('number'), 'value');
        return null;
      },

      multipleOf(node, ctx) {
        if (node && node.multipleOf && typeof node.multipleOf !== 'number') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('number'), 'value');
        return null;
      },

      exclusiveMaximum(node, ctx) {
        if (node && node.exclusiveMaximum && typeof node.exclusiveMaximum !== 'boolean') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('boolean'), 'value');
        return null;
      },

      exclusiveMinimum(node, ctx) {
        if (node && node.exclusiveMinimum && typeof node.exclusiveMinimum !== 'boolean') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('boolean'), 'value');
        return null;
      },

      uniqueItems(node, ctx) {
        if (node && node.uniqueItems && typeof node.uniqueItems !== 'boolean') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('boolean'), 'value');
        return null;
      }

    };
  }

  OAS2Items() {
    return {
      onEnter: (node, definition, ctx) => ctx.validateFields(this.config, this.rule, this.validators)
    };
  }

}

module.exports = ValidateOAS2Items;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy92aXNpdG9ycy9ydWxlcy9vYXMyLXN0cnVjdHVyYWwvdmFsaWRhdGVPQVMySXRlbXMuanMiXSwibmFtZXMiOlsiVmFsaWRhdGVPQVMySXRlbXMiLCJydWxlIiwidmFsaWRhdG9ycyIsInR5cGUiLCJub2RlIiwiY3R4IiwiY3JlYXRlRXJyb3IiLCJtZXNzYWdlSGVscGVycyIsIm1pc3NpbmdSZXF1aXJlZEZpZWxkIiwiZmllbGRUeXBlTWlzbWF0Y2hNZXNzYWdlSGVscGVyIiwiZm9ybWF0IiwiaXRlbXMiLCJjb2xsZWN0aW9uRm9ybWF0IiwiaW5jbHVkZXMiLCJwb3NzaWJsZUFsdGVybmF0ZSIsInBhdHRlcm4iLCJtYXhpbXVtIiwibWluaW11bSIsIm1heExlbmd0aCIsIm1pbkxlbmd0aCIsIm1heEl0ZW1zIiwibWluSXRlbXMiLCJtdWx0aXBsZU9mIiwiZXhjbHVzaXZlTWF4aW11bSIsImV4Y2x1c2l2ZU1pbmltdW0iLCJ1bmlxdWVJdGVtcyIsIk9BUzJJdGVtcyIsIm9uRW50ZXIiLCJkZWZpbml0aW9uIiwidmFsaWRhdGVGaWVsZHMiLCJjb25maWciLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUVBLE1BQU1BLGlCQUFOLENBQXdCO0FBQ3RCLGFBQVdDLElBQVgsR0FBa0I7QUFDaEIsV0FBTyxtQkFBUDtBQUNEOztBQUVELE1BQUlDLFVBQUosR0FBaUI7QUFDZixXQUFPO0FBQ0xDLE1BQUFBLElBQUksQ0FBQ0MsSUFBRCxFQUFPQyxHQUFQLEVBQVk7QUFDZCxZQUFJRCxJQUFJLElBQUksQ0FBQ0EsSUFBSSxDQUFDRCxJQUFsQixFQUF3QjtBQUN0QixpQkFBT0UsR0FBRyxDQUFDQyxXQUFKLENBQWdCRCxHQUFHLENBQUNFLGNBQUosQ0FBbUJDLG9CQUFuQixDQUF3QyxNQUF4QyxDQUFoQixFQUFpRSxLQUFqRSxDQUFQO0FBQ0Q7O0FBQ0QsWUFBSUosSUFBSSxJQUFJQSxJQUFJLENBQUNELElBQWIs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QUFnQixDQUFDcEIsSUFBRCxFQUFPQyxHQUFQLEVBQVk7QUFDMUIsWUFBSUQsSUFBSSxJQUFJQSxJQUFJLENBQUNvQixnQkFBYixJQUFpQyxPQUFPcEIsSUFBSSxDQUFDb0IsZ0JBQVosS0FBaUMsU0FBdEUsRUFBaUYsT0FBT25CLEdBQUcsQ0FBQ0MsV0FBSixDQUFnQkQsR0FBRyxDQUFDRSxjQUFKLENBQW1CRSw4QkFBbkIsQ0FBa0QsU0FBbEQsQ0FBaEIsRUFBOEUsT0FBOUUsQ0FBUDtBQUNqRixlQUFPLElBQVA7QUFDRCxPQWpFSTs7QUFrRUxnQixNQUFBQSxXQUFXLENBQUNyQixJQUFELEVBQU9DLEdBQVAsRUFBWTtBQUNyQixZQUFJRCxJQUFJLElBQUlBLElBQUksQ0FBQ3FCLFdBQWIsSUFBNEIsT0FBT3JCLElBQUksQ0FBQ3FCLFdBQVosS0FBNEIsU0FBNUQsRUFBdUUsT0FBT3BCLEdBQUcsQ0FBQ0MsV0FBSixDQUFnQkQsR0FBRyxDQUFDRSxjQUFKLENBQW1CRSw4QkFBbkIsQ0FBa0QsU0FBbEQsQ0FBaEIsRUFBOEUsT0FBOUUsQ0FBUDtBQUN2RSxlQUFPLElBQVA7QUFDRDs7QUFyRUksS0FBUDtBQXVFRDs7QUFFRGlCLEVBQUFBLFNBQVMsR0FBRztBQUNWLFdBQU87QUFDTEMsTUFBQUEsT0FBTyxFQUFFLENBQUN2QixJQUFELEVBQU93QixVQUFQLEVBQW1CdkIsR0FBbkIsS0FBMkJBLEdBQUcsQ0FBQ3dCLGNBQUosQ0FDbEMsS0FBS0MsTUFENkIsRUFDckIsS0FBSzdCLElBRGdCLEVBQ1YsS0FBS0MsVUFESztBQUQvQixLQUFQO0FBS0Q7O0FBckZxQjs7QUF3RnhCNkIsTUFBTSxDQUFDQyxPQUFQLEdBQWlCaEMsaUJBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q2xvc2VzdFN0cmluZyB9IGZyb20gJy4uLy4uLy4uL3V0aWxzJztcblxuY2xhc3MgVmFsaWRhdGVPQVMySXRlbXMge1xuICBzdGF0aWMgZ2V0IHJ1bGUoKSB7XG4gICAgcmV0dXJuICdvYXMyLXNjaGVtYS9pdGVtcyc7XG4gIH1cblxuICBnZXQgdmFsaWRhdG9ycygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZShub2RlLCBjdHgpIHtcbiAgICAgICAgaWYgKG5vZGUgJiYgIW5vZGUudHlwZSkge1xuICAgICAgICAgIHJldHVybiBjdHguY3JlYXRlRXJyb3IoY3R4Lm1lc3NhZ2VIZWxwZXJzLm1pc3NpbmdSZXF1aXJlZEZpZWxkKCd0eXBlJyksICdrZXknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZSAmJiBub2RlLnR5cGUgJiYgdHlwZW9mIG5vZGUudHlwZSAhPT0gJ3N0cmluZycpIHJldHVybiBjdHguY3JlYXRlRXJyb3IoY3R4Lm1lc3NhZ2VIZWxwZXJzLmZpZWxkVHlwZU1pc21hdGNoTWVzc2FnZUhlbHBlcignc3RyaW5nJyksICd2YWx1ZScpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0sXG4gICAgICBmb3JtYXQobm9kZSwgY3R4KSB7XG4gICAgICAgIGlmIChub2RlICYmIG5vZGUuZm9ybWF0ICYmIHR5cGVvZiBub2RlLmZvcm1hdCAhPT0gJ3N0cmluZycpIHJldHVybiBjdHguY3JlYXRlRXJyb3IoY3R4Lm1lc3NhZ2VIZWxwZXJzLmZpZWxkVHlwZU1pc21hdGNoTWVzc2FnZUhlbHBlcignc3RyaW5nJyksICd2YWx1ZScpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0sXG4gICAgICBpdGVtcyhub2RlLCBjdHgpIHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS50eXBlID09PSAnYXJyYXknICYmICFub2RlLml0ZW1zKSB7XG4gICAgICAgICAgcmV0dXJuIGN0eC5jcmVhdGVFcnJvcihjdHgubWVzc2FnZUhlbHBlcnMubWlzc2luZ1JlcXVpcmVkRmllbGQoJ2l0ZW1zJyksICdrZXknKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0sXG4gICAgICBjb2xsZWN0aW9uRm9ybWF0KG5vZGUsIGN0eCkge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLmNvbGxlY3Rpb25Gb3JtYXQgJiYgdHlwZW9mIG5vZGUuY29sbGVjdGlvbkZvcm1hdCAhPT0gJ3N0cmluZycpIHJldHVybiBjdHguY3JlYXRlRXJyb3IoY3R4Lm1lc3NhZ2VIZWxwZXJzLmZpZWxkVHlwZU1pc21hdGNoTWVzc2FnZUhlbHBlcignc3RyaW5nJyksICd2YWx1ZScpO1xuICAgICAgICBpZiAobm9kZS5jb2xsZWN0aW9uRm9ybWF0ICYmICFbJ2NzdicsICdzc3YnLCAndHN2JywgJ3BpcGVzJywgJ211bHRpJ10uaW5jbHVkZXMobm9kZS5jb2xsZWN0aW9uRm9ybWF0KSkge1xuICAgICAgICAgIGNvbnN0IHBvc3NpYmxlQWx0ZXJuYXRlID0gZ2V0Q2xvc2VzdFN0cmluZyhub2RlLnR5cGUsIFsnY3N2JywgJ3NzdicsICd0c3YnLCAncGlwZXMnLCAnbXVsdGknXSk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5jcmVhdGVFcnJvcignVGhlIHZhbHVlIG9mIFwiY29sbGVjdGlvbkZvcm1hdFwiIGZpZWxkIGNhbiBiZSBvbmUgb2YgZm9sbG93aW5nIG9ubHk6IFwiY3N2XCIsIFwic3N2XCIsIFwidHN2XCIsIFwicGlwZXNcIiwgXCJtdWx0aVwiLicsICd2YWx1ZScsIHsgcG9zc2libGVBbHRlcm5hdGUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgcGF0dGVybihub2RlLCBjdHgpIHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5wYXR0ZXJuICYmIHR5cGVvZiBub2RlLnBhdHRlcm4gIT09ICdzdHJpbmcnKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ3N0cmluZycpLCAndmFsdWUnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgbWF4aW11bShub2RlLCBjdHgpIHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5tYXhpbXVtICYmIHR5cGVvZiBub2RlLm1heGltdW0gIT09ICdudW1iZXInKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ251bWJlcicpLCAndmFsdWUnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgbWluaW11bShub2RlLCBjdHgpIHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5taW5pbXVtICYmIHR5cGVvZiBub2RlLm1pbmltdW0gIT09ICdudW1iZXInKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ251bWJlcicpLCAndmFsdWUnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgbWF4TGVuZ3RoKG5vZGUsIGN0eCkge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLm1heExlbmd0aCAmJiB0eXBlb2Ygbm9kZS5tYXhMZW5ndGggIT09ICdudW1iZXInKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ251bWJlcicpLCAndmFsdWUnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgbWluTGVuZ3RoKG5vZGUsIGN0eCkge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLm1pbkxlbmd0aCAmJiB0eXBlb2Ygbm9kZS5taW5MZW5ndGggIT09ICdudW1iZXInKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ251bWJlcicpLCAndmFsdWUnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgbWF4SXRlbXMobm9kZSwgY3R4KSB7XG4gICAgICAgIGlmIChub2RlICYmIG5vZGUubWF4SXRlbXMgJiYgdHlwZW9mIG5vZGUubWF4SXRlbXMgIT09ICdudW1iZXInKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ251bWJlcicpLCAndmFsdWUnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgbWluSXRlbXMobm9kZSwgY3R4KSB7XG4gICAgICAgIGlmIChub2RlICYmIG5vZGUubWluSXRlbXMgJiYgdHlwZW9mIG5vZGUubWluSXRlbXMgIT09ICdudW1iZXInKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ251bWJlcicpLCAndmFsdWUnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgbXVsdGlwbGVPZihub2RlLCBjdHgpIHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5tdWx0aXBsZU9mICYmIHR5cGVvZiBub2RlLm11bHRpcGxlT2YgIT09ICdudW1iZXInKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ251bWJlcicpLCAndmFsdWUnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgZXhjbHVzaXZlTWF4aW11bShub2RlLCBjdHgpIHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5leGNsdXNpdmVNYXhpbXVtICYmIHR5cGVvZiBub2RlLmV4Y2x1c2l2ZU1heGltdW0gIT09ICdib29sZWFuJykgcmV0dXJuIGN0eC5jcmVhdGVFcnJvcihjdHgubWVzc2FnZUhlbHBlcnMuZmllbGRUeXBlTWlzbWF0Y2hNZXNzYWdlSGVscGVyKCdib29sZWFuJyksICd2YWx1ZScpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0sXG4gICAgICBleGNsdXNpdmVNaW5pbXVtKG5vZGUsIGN0eCkge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLmV4Y2x1c2l2ZU1pbmltdW0gJiYgdHlwZW9mIG5vZGUuZXhjbHVzaXZlTWluaW11bSAhPT0gJ2Jvb2xlYW4nKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ2Jvb2xlYW4nKSwgJ3ZhbHVlJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSxcbiAgICAgIHVuaXF1ZUl0ZW1zKG5vZGUsIGN0eCkge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLnVuaXF1ZUl0ZW1zICYmIHR5cGVvZiBub2RlLnVuaXF1ZUl0ZW1zICE9PSAnYm9vbGVhbicpIHJldHVybiBjdHguY3JlYXRlRXJyb3IoY3R4Lm1lc3NhZ2VIZWxwZXJzLmZpZWxkVHlwZU1pc21hdGNoTWVzc2FnZUhlbHBlcignYm9vbGVhbicpLCAndmFsdWUnKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgIH07XG4gIH1cblxuICBPQVMySXRlbXMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG9uRW50ZXI6IChub2RlLCBkZWZpbml0aW9uLCBjdHgpID0+IGN0eC52YWxpZGF0ZUZpZWxkcyhcbiAgICAgICAgdGhpcy5jb25maWcsIHRoaXMucnVsZSwgdGhpcy52YWxpZGF0b3JzLFxuICAgICAgKSxcbiAgICB9O1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gVmFsaWRhdGVPQVMySXRlbXM7XG4iXX0=