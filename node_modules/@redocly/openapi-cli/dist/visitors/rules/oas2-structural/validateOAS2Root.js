"use strict";

class ValidateOpenAPIRoot {
  static get rule() {
    return 'oas2-schema/root';
  }

  get validators() {
    return {
      info(node, ctx) {
        if (node && !node.info) return ctx.createError(ctx.messageHelpers.missingRequiredField('info'), 'key');
        return null;
      },

      paths(node, ctx) {
        if (node && !node.paths) return ctx.createError(ctx.messageHelpers.missingRequiredField('paths'), 'key');
        return null;
      },

      host(node, ctx) {
        if (node.host && typeof node.host !== 'string') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('string'), 'value');
        return null;
      },

      basePath(node, ctx) {
        if (node.basePath && typeof node.basePath !== 'string') return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('string'), 'value');
        return null;
      },

      schemes(node, ctx) {
        if (!node || !node.schemes) return null;
        const errors = [];

        if (node && node.schemes && !Array.isArray(node.schemes)) {
          return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('array'), 'value');
        }

        for (let i = 0; i < node.schemes.length; i++) {
          if (typeof node.schemes[i] !== 'string') {
            ctx.path.push(i);
            errors.push(ctx.createError('Items of the schemes array must be strings in the OAS2 Root object.', 'value'));
            ctx.path.pop();
          }
        }

        for (let i = 0; i < node.schemes.length; i++) {
          if (['http', 'https', 'ws', 'wss'].indexOf(node.schemes[i]) === -1) {
            ctx.path.push(i);
            errors.push(ctx.createError('Items of the schemes array can only be: "http", "https", "ws", "wss".', 'value'));
            ctx.path.pop();
          }
        }

        return errors;
      },

      consumes(node, ctx) {
        if (!node || !node.consumes) return null;
        const errors = [];

        if (node && node.consumes && !Array.isArray(node.consumes)) {
          return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('array'), 'value');
        }

        for (let i = 0; i < node.consumes.length; i++) {
          if (typeof node.consumes[i] !== 'string') {
            ctx.path.push(i);
            errors.push(ctx.createError('Value MUST be a string and as described under Mime Types.', 'value'));
            ctx.path.pop();
          }
        }

        return errors;
      },

      produces(node, ctx) {
        if (!node || !node.produces) return null;
        const errors = [];

        if (node && node.produces && !Array.isArray(node.produces)) {
          return ctx.createError(ctx.messageHelpers.fieldTypeMismatchMessageHelper('array'), 'value');
        }

        for (let i = 0; i < node.produces.length; i++) {
          if (typeof node.produces[i] !== 'string') {
            ctx.path.push(i);
            errors.push(ctx.createError('Value MUST be a string and as described under Mime Types.', 'value'));
            ctx.path.pop();
          }
        }

        return errors;
      }

    };
  }

  OAS2Root() {
    return {
      onEnter: (node, definition, ctx) => ctx.validateFields(this.config, this.rule, this.validators)
    };
  }

}

module.exports = ValidateOpenAPIRoot;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy92aXNpdG9ycy9ydWxlcy9vYXMyLXN0cnVjdHVyYWwvdmFsaWRhdGVPQVMyUm9vdC5qcyJdLCJuYW1lcyI6WyJWYWxpZGF0ZU9wZW5BUElSb290IiwicnVsZSIsInZhbGlkYXRvcnMiLCJpbmZvIiwibm9kZSIsImN0eCIsImNyZWF0ZUVycm9yIiwibWVzc2FnZUhlbHBlcnMiLCJtaXNzaW5nUmVxdWlyZWRGaWVsZCIsInBhdGhzIiwiaG9zdCIsImZpZWxkVHlwZU1pc21hdGNoTWVzc2FnZUhlbHBlciIsImJhc2VQYXRoIiwic2NoZW1lcyIsImVycm9ycyIsIkFycmF5IiwiaXNBcnJheSIsImkiLCJsZW5ndGgiLCJwYXRoIiwicHVzaCIsInBvcCIsImluZGV4T2YiLCJjb25zdW1lcyIsInByb2R1Y2VzIiwiT0FTMlJvb3QiLCJvbkVudGVyIiwiZGVmaW5pdGlvbiIsInZhbGlkYXRlRmllbGRzIiwiY29uZmlnIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxtQkFBTixDQUEwQjtBQUN4QixhQUFXQyxJQUFYLEdBQWtCO0FBQ2hCLFdBQU8sa0JBQVA7QUFDRDs7QUFFRCxNQUFJQyxVQUFKLEdBQWlCO0FBQ2YsV0FBTztBQUNMQyxNQUFBQSxJQUFJLENBQUNDLElBQUQsRUFBT0MsR0FBUCxFQUFZO0FBQ2QsWUFBSUQsSUFBSSxJQUFJLENBQUNBLElBQUksQ0FBQ0QsSUFBbEIsRUFBd0IsT0FBT0UsR0FBRyxDQUFDQyxXQUFKLENBQWdCRCxHQUFHLENBQUNFLGNBQUosQ0FBbUJDLG9CQUFuQixDQUF3QyxNQUF4QyxDQUFoQixFQUFpRSxLQUFqRSxDQUFQO0FBQ3hCLGVBQU8sSUFBUDtBQUNELE9BSkk7O0FBS0xDLE1BQUFBLEtBQUssQ0FBQ0wsSUFBRCxFQUFPQyxHQUFQLEVBQVk7QUFDZixZQUFJRCxJQUFJLElBQUksQ0FBQ0EsSUFBSSxDQUFDSyxLQUFsQixFQUF5QixPQUFPSixHQUFHLENBQUND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LGlCQUFPbkIsR0FBRyxDQUFDQyxXQUFKLENBQWdCRCxHQUFHLENBQUNFLGNBQUosQ0FBbUJJLDhCQUFuQixDQUFrRCxPQUFsRCxDQUFoQixFQUE0RSxPQUE1RSxDQUFQO0FBQ0Q7O0FBRUQsYUFBSyxJQUFJTSxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHYixJQUFJLENBQUNvQixRQUFMLENBQWNOLE1BQWxDLEVBQTBDRCxDQUFDLEVBQTNDLEVBQStDO0FBQzdDLGNBQUksT0FBT2IsSUFBSSxDQUFDb0IsUUFBTCxDQUFjUCxDQUFkLENBQVAsS0FBNEIsUUFBaEMsRUFBMEM7QUFDeENaLFlBQUFBLEdBQUcsQ0FBQ2MsSUFBSixDQUFTQyxJQUFULENBQWNILENBQWQ7QUFDQUgsWUFBQUEsTUFBTSxDQUFDTSxJQUFQLENBQVlmLEdBQUcsQ0FBQ0MsV0FBSixDQUFnQiwyREFBaEIsRUFBNkUsT0FBN0UsQ0FBWjtBQUNBRCxZQUFBQSxHQUFHLENBQUNjLElBQUosQ0FBU0UsR0FBVDtBQUNEO0FBQ0Y7O0FBRUQsZUFBT1AsTUFBUDtBQUNEOztBQWhGSSxLQUFQO0FBa0ZEOztBQUVEVyxFQUFBQSxRQUFRLEdBQUc7QUFDVCxXQUFPO0FBQ0xDLE1BQUFBLE9BQU8sRUFBRSxDQUFDdEIsSUFBRCxFQUFPdUIsVUFBUCxFQUFtQnRCLEdBQW5CLEtBQTJCQSxHQUFHLENBQUN1QixjQUFKLENBQ2xDLEtBQUtDLE1BRDZCLEVBQ3JCLEtBQUs1QixJQURnQixFQUNWLEtBQUtDLFVBREs7QUFEL0IsS0FBUDtBQUtEOztBQWhHdUI7O0FBbUcxQjRCLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQi9CLG1CQUFqQiIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFZhbGlkYXRlT3BlbkFQSVJvb3Qge1xuICBzdGF0aWMgZ2V0IHJ1bGUoKSB7XG4gICAgcmV0dXJuICdvYXMyLXNjaGVtYS9yb290JztcbiAgfVxuXG4gIGdldCB2YWxpZGF0b3JzKCkge1xuICAgIHJldHVybiB7XG4gICAgICBpbmZvKG5vZGUsIGN0eCkge1xuICAgICAgICBpZiAobm9kZSAmJiAhbm9kZS5pbmZvKSByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5taXNzaW5nUmVxdWlyZWRGaWVsZCgnaW5mbycpLCAna2V5Jyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSxcbiAgICAgIHBhdGhzKG5vZGUsIGN0eCkge1xuICAgICAgICBpZiAobm9kZSAmJiAhbm9kZS5wYXRocykgcmV0dXJuIGN0eC5jcmVhdGVFcnJvcihjdHgubWVzc2FnZUhlbHBlcnMubWlzc2luZ1JlcXVpcmVkRmllbGQoJ3BhdGhzJyksICdrZXknKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9LFxuICAgICAgaG9zdChub2RlLCBjdHgpIHtcbiAgICAgICAgaWYgKG5vZGUuaG9zdCAmJiB0eXBlb2Ygbm9kZS5ob3N0ICE9PSAnc3RyaW5nJykgcmV0dXJuIGN0eC5jcmVhdGVFcnJvcihjdHgubWVzc2FnZUhlbHBlcnMuZmllbGRUeXBlTWlzbWF0Y2hNZXNzYWdlSGVscGVyKCdzdHJpbmcnKSwgJ3ZhbHVlJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSxcbiAgICAgIGJhc2VQYXRoKG5vZGUsIGN0eCkge1xuICAgICAgICBpZiAobm9kZS5iYXNlUGF0aCAmJiB0eXBlb2Ygbm9kZS5iYXNlUGF0aCAhPT0gJ3N0cmluZycpIHJldHVybiBjdHguY3JlYXRlRXJyb3IoY3R4Lm1lc3NhZ2VIZWxwZXJzLmZpZWxkVHlwZU1pc21hdGNoTWVzc2FnZUhlbHBlcignc3RyaW5nJyksICd2YWx1ZScpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0sXG4gICAgICBzY2hlbWVzKG5vZGUsIGN0eCkge1xuICAgICAgICBpZiAoIW5vZGUgfHwgIW5vZGUuc2NoZW1lcykgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgZXJyb3JzID0gW107XG5cbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5zY2hlbWVzICYmICFBcnJheS5pc0FycmF5KG5vZGUuc2NoZW1lcykpIHtcbiAgICAgICAgICByZXR1cm4gY3R4LmNyZWF0ZUVycm9yKGN0eC5tZXNzYWdlSGVscGVycy5maWVsZFR5cGVNaXNtYXRjaE1lc3NhZ2VIZWxwZXIoJ2FycmF5JyksICd2YWx1ZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2RlLnNjaGVtZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG5vZGUuc2NoZW1lc1tpXSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGN0eC5wYXRoLnB1c2goaSk7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChjdHguY3JlYXRlRXJyb3IoJ0l0ZW1zIG9mIHRoZSBzY2hlbWVzIGFycmF5IG11c3QgYmUgc3RyaW5ncyBpbiB0aGUgT0FTMiBSb290IG9iamVjdC4nLCAndmFsdWUnKSk7XG4gICAgICAgICAgICBjdHgucGF0aC5wb3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGUuc2NoZW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChbJ2h0dHAnLCAnaHR0cHMnLCAnd3MnLCAnd3NzJ10uaW5kZXhPZihub2RlLnNjaGVtZXNbaV0pID09PSAtMSkge1xuICAgICAgICAgICAgY3R4LnBhdGgucHVzaChpKTtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKGN0eC5jcmVhdGVFcnJvcignSXRlbXMgb2YgdGhlIHNjaGVtZXMgYXJyYXkgY2FuIG9ubHkgYmU6IFwiaHR0cFwiLCBcImh0dHBzXCIsIFwid3NcIiwgXCJ3c3NcIi4nLCAndmFsdWUnKSk7XG4gICAgICAgICAgICBjdHgucGF0aC5wb3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVycm9ycztcbiAgICAgIH0sXG4gICAgICBjb25zdW1lcyhub2RlLCBjdHgpIHtcbiAgICAgICAgaWYgKCFub2RlIHx8ICFub2RlLmNvbnN1bWVzKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCBlcnJvcnMgPSBbXTtcblxuICAgICAgICBpZiAobm9kZSAmJiBub2RlLmNvbnN1bWVzICYmICFBcnJheS5pc0FycmF5KG5vZGUuY29uc3VtZXMpKSB7XG4gICAgICAgICAgcmV0dXJuIGN0eC5jcmVhdGVFcnJvcihjdHgubWVzc2FnZUhlbHBlcnMuZmllbGRUeXBlTWlzbWF0Y2hNZXNzYWdlSGVscGVyKCdhcnJheScpLCAndmFsdWUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZS5jb25zdW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmICh0eXBlb2Ygbm9kZS5jb25zdW1lc1tpXSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGN0eC5wYXRoLnB1c2goaSk7XG4gICAgICAgICAgICBlcnJvcnMucHVzaChjdHguY3JlYXRlRXJyb3IoJ1ZhbHVlIE1VU1QgYmUgYSBzdHJpbmcgYW5kIGFzIGRlc2NyaWJlZCB1bmRlciBNaW1lIFR5cGVzLicsICd2YWx1ZScpKTtcbiAgICAgICAgICAgIGN0eC5wYXRoLnBvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBlcnJvcnM7XG4gICAgICB9LFxuICAgICAgcHJvZHVjZXMobm9kZSwgY3R4KSB7XG4gICAgICAgIGlmICghbm9kZSB8fCAhbm9kZS5wcm9kdWNlcykgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgZXJyb3JzID0gW107XG5cbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5wcm9kdWNlcyAmJiAhQXJyYXkuaXNBcnJheShub2RlLnByb2R1Y2VzKSkge1xuICAgICAgICAgIHJldHVybiBjdHguY3JlYXRlRXJyb3IoY3R4Lm1lc3NhZ2VIZWxwZXJzLmZpZWxkVHlwZU1pc21hdGNoTWVzc2FnZUhlbHBlcignYXJyYXknKSwgJ3ZhbHVlJyk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGUucHJvZHVjZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG5vZGUucHJvZHVjZXNbaV0gIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBjdHgucGF0aC5wdXNoKGkpO1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goY3R4LmNyZWF0ZUVycm9yKCdWYWx1ZSBNVVNUIGJlIGEgc3RyaW5nIGFuZCBhcyBkZXNjcmliZWQgdW5kZXIgTWltZSBUeXBlcy4nLCAndmFsdWUnKSk7XG4gICAgICAgICAgICBjdHgucGF0aC5wb3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXJyb3JzO1xuICAgICAgfSxcbiAgICB9O1xuICB9XG5cbiAgT0FTMlJvb3QoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG9uRW50ZXI6IChub2RlLCBkZWZpbml0aW9uLCBjdHgpID0+IGN0eC52YWxpZGF0ZUZpZWxkcyhcbiAgICAgICAgdGhpcy5jb25maWcsIHRoaXMucnVsZSwgdGhpcy52YWxpZGF0b3JzLFxuICAgICAgKSxcbiAgICB9O1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gVmFsaWRhdGVPcGVuQVBJUm9vdDtcbiJdfQ==